<div>
  <h2 class="mt-3">New book</h2>
  <%= form_with model: book do |f| %>
    <div class="mb-3">
      <%= f.label :title, class: "form-label"%>
      <%= f.text_field :title, class: "form-control" %>
    </div>
    <div class="mb-3">
      <%= f.label :body, class: "form-label" %>
      <%= f.text_area :body, class: "form-control" %>
    </div>
    <div class="mb-3">
      <%= f.label "タグ", for: "book_tag", class: "form-label" %>
      <%= f.text_field :tag, class: "form-control"%>
    </div>
    <div class="mb-3 d-flex">
      <p class="mr-1">Rate</p>
      <div id="post_raty"></div>
    </div>
    <%= f.submit 'Create Book', class: "btn btn-success" %>
  <% end %>
</div>

<script>
  // Raty用JavaScript: 実際に五段階表記はraty()によって作られている。
  // elem：div要素位置の特定
  // opt：ratyに使用する画像、オプション（編集不可、値等）を設定
  var elem = document.querySelector('#post_raty');
  // Turbolinkにより、ブラウザバック時Javascriptが余分にもう一度読まれるのを、
  // 「値がすでに入っている場合行わない」ことで回避。
  if (elem.children.length == 0) {
    var opt = {
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    scoreName: 'book[score]'
  };
  raty(elem, opt);
  };
</script>